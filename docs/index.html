<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Spatial Analysis with Misaligned Data Using Atom-Based Regression Models • spatialAtomizeR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" sizes="any" href="favicon.ico">
<link rel="manifest" href="site.webmanifest">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Spatial Analysis with Misaligned Data Using Atom-Based Regression Models">
<meta name="description" content="Implements atom-based regression models (ABRM) for analyzing spatially misaligned data. Provides functions for simulating misaligned spatial data, preparing NIMBLE model inputs, running MCMC diagnostics, and providing results. All main functions return S3 objects with print(), summary(), and plot() methods for intuitive result exploration. Methods originally described in Mugglin et al. (2000) &lt;doi:10.1080/01621459.2000.10474279&gt;, further investigated in Trevisani &amp; Gelfand (2013), and applied in Nethery et al. (2023) &lt;doi:10.1101/2023.01.10.23284410&gt;.">
<meta property="og:description" content="Implements atom-based regression models (ABRM) for analyzing spatially misaligned data. Provides functions for simulating misaligned spatial data, preparing NIMBLE model inputs, running MCMC diagnostics, and providing results. All main functions return S3 objects with print(), summary(), and plot() methods for intuitive result exploration. Methods originally described in Mugglin et al. (2000) &lt;doi:10.1080/01621459.2000.10474279&gt;, further investigated in Trevisani &amp; Gelfand (2013), and applied in Nethery et al. (2023) &lt;doi:10.1101/2023.01.10.23284410&gt;.">
<meta property="og:image" content="/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">spatialAtomizeR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/getting-started.html">Getting Started with spatialAtomizeR</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bellayqian/spatialAtomizeR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="spatialatomizer-">spatialAtomizeR <a class="anchor" aria-label="anchor" href="#spatialatomizer-"></a>
</h1>
</div>
<p>Bayesian Spatial Regression with Misaligned Data</p>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p><code>spatialAtomizeR</code> implements Bayesian atom-based regression methods (ABRM) for assessing associations between spatially-misaligned variables, i.e., variables measured over two distinct and non-nested sets of spatial areas. The ABRM approach does not require any a priori re-alignment of the variables. This package uses Nimble under the hood for flexible and efficient Bayesian implementation. The package handles situations where:</p>
<ul>
<li>Outcome data and some covariates are measured on one spatial scale (called the “Y-grid”), while the remaining covariates are measured on a different spatial scale (called the “X-grid”)</li>
<li>The areas comprising the two spatial scales are misaligned, i.e., have mismatched boundaries, and neither scale is fully nested within the other</li>
<li>Variables follow different distributions (normal, Poisson, binomial)</li>
</ul>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version from GitHub:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"bellayqian/spatialAtomizeR"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="quick-start">Quick Start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<div class="section level3">
<h3 id="basic-workflow">Basic Workflow<a class="anchor" aria-label="anchor" href="#basic-workflow"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bellayqian/spatialAtomizeR" class="external-link">spatialAtomizeR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-nimble.org" class="external-link">nimble</a></span><span class="op">)</span>  <span class="co"># Required for ABRM models</span></span>
<span></span>
<span><span class="co"># 1. Simulate misaligned spatial data with full parameter specification</span></span>
<span><span class="va">sim_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/simulate_misaligned_data.html">simulate_misaligned_data</a></span><span class="op">(</span></span>
<span>  seed <span class="op">=</span> <span class="fl">42</span>,</span>
<span>  dist_covariates_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'normal'</span>, <span class="st">'poisson'</span>, <span class="st">'binomial'</span><span class="op">)</span>,</span>
<span>  dist_covariates_y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'normal'</span>, <span class="st">'poisson'</span>, <span class="st">'binomial'</span><span class="op">)</span>,</span>
<span>  dist_y <span class="op">=</span> <span class="st">'poisson'</span>,</span>
<span>  x_intercepts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>,      <span class="co"># Intercepts for X covariates</span></span>
<span>  y_intercepts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>,      <span class="co"># Intercepts for Y covariates</span></span>
<span>  x_correlation <span class="op">=</span> <span class="fl">0.5</span>,              <span class="co"># Spatial correlation for X</span></span>
<span>  y_correlation <span class="op">=</span> <span class="fl">0.5</span>,              <span class="co"># Spatial correlation for Y</span></span>
<span>  beta0_y <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,                     <span class="co"># Outcome intercept</span></span>
<span>  beta_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.03</span>, <span class="fl">0.1</span>, <span class="op">-</span><span class="fl">0.2</span><span class="op">)</span>,    <span class="co"># Coefficients for X covariates</span></span>
<span>  beta_y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.03</span>, <span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0.2</span><span class="op">)</span>      <span class="co"># Coefficients for Y covariates</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. Get NIMBLE model code</span></span>
<span><span class="va">model_code</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_abrm_model.html">get_abrm_model</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 3. Run ABRM analysis</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/run_abrm.html">run_abrm</a></span><span class="op">(</span></span>
<span>  gridx <span class="op">=</span> <span class="va">sim_data</span><span class="op">$</span><span class="va">gridx</span>,</span>
<span>  gridy <span class="op">=</span> <span class="va">sim_data</span><span class="op">$</span><span class="va">gridy</span>,</span>
<span>  atoms <span class="op">=</span> <span class="va">sim_data</span><span class="op">$</span><span class="va">atoms</span>,</span>
<span>  model_code <span class="op">=</span> <span class="va">model_code</span>,</span>
<span>  true_params <span class="op">=</span> <span class="va">sim_data</span><span class="op">$</span><span class="va">true_params</span>, <span class="co"># optional vector of true outcome model coefficient parameters</span></span>
<span>  norm_idx_x <span class="op">=</span> <span class="fl">1</span>,   <span class="co"># Index of normal-distributed X covariate</span></span>
<span>  pois_idx_x <span class="op">=</span> <span class="fl">2</span>,   <span class="co"># Index of Poisson-distributed X covariate</span></span>
<span>  binom_idx_x <span class="op">=</span> <span class="fl">3</span>,  <span class="co"># Index of binomial-distributed X covariate</span></span>
<span>  norm_idx_y <span class="op">=</span> <span class="fl">1</span>,   <span class="co"># Index of normal-distributed Y covariate</span></span>
<span>  pois_idx_y <span class="op">=</span> <span class="fl">2</span>,   <span class="co"># Index of Poisson-distributed Y covariate</span></span>
<span>  binom_idx_y <span class="op">=</span> <span class="fl">3</span>,  <span class="co"># Index of binomial-distributed Y covariate</span></span>
<span>  dist_y <span class="op">=</span> <span class="fl">2</span>,       <span class="co"># Outcome distribution: 1=normal, 2=poisson, 3=binomial</span></span>
<span>  niter <span class="op">=</span> <span class="fl">50000</span>,    <span class="co"># MCMC iterations</span></span>
<span>  nburnin <span class="op">=</span> <span class="fl">30000</span>,  <span class="co"># Burn-in iterations</span></span>
<span>  nchains <span class="op">=</span> <span class="fl">2</span>       <span class="co"># Number of chains</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 4. View results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">parameter_estimates</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="main-features">Main Features<a class="anchor" aria-label="anchor" href="#main-features"></a>
</h2>
<div class="section level3">
<h3 id="data-simulation">Data Simulation<a class="anchor" aria-label="anchor" href="#data-simulation"></a>
</h3>
<ul>
<li>Create two spatial grids (“X-grid” and “Y-grid”) with non-nested spatial misalignment</li>
<li>Generate synthetic spatially correlated variables with customizable distributions over each spatial grid</li>
<li>Specify true parameter values for validation</li>
</ul>
</div>
<div class="section level3">
<h3 id="model-fitting">Model Fitting<a class="anchor" aria-label="anchor" href="#model-fitting"></a>
</h3>
<ul>
<li>Atom-based Bayesian regression with NIMBLE</li>
<li>Support for mixed-type variables (normal, Poisson, binomial)</li>
<li>Multivariate CAR models to allow for information-sharing over space and across variables</li>
<li>Automatic convergence diagnostics</li>
</ul>
</div>
<div class="section level3">
<h3 id="s3-object-system">S3 Object System<a class="anchor" aria-label="anchor" href="#s3-object-system"></a>
</h3>
<p>All main functions return S3 objects with dedicated print, summary, and plot methods:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create simulated data</span></span>
<span><span class="va">sim_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/simulate_misaligned_data.html">simulate_misaligned_data</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">sim_data</span><span class="op">)</span>  <span class="co"># "misaligned_data"</span></span>
<span></span>
<span><span class="co"># View results with clean formatting</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">sim_data</span><span class="op">)</span>   <span class="co"># Clean overview</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">sim_data</span><span class="op">)</span> <span class="co"># Detailed information</span></span>
<span></span>
<span><span class="co"># Run ABRM analysis</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/run_abrm.html">run_abrm</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span>    <span class="co"># "abrm"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span>    <span class="co"># Shows parameter count, bias, coverage</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span>  <span class="co"># Shows full parameter table</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span>     <span class="co"># Shows MCMC diagnostic plots</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="s3-methods-examples">S3 Methods Examples<a class="anchor" aria-label="anchor" href="#s3-methods-examples"></a>
</h2>
<p>The package provides intuitive S3 methods for all major output types:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulated data</span></span>
<span><span class="va">sim_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/simulate_misaligned_data.html">simulate_misaligned_data</a></span><span class="op">(</span>seed <span class="op">=</span> <span class="fl">123</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">sim_data</span><span class="op">)</span></span>
<span><span class="co"># Output:</span></span>
<span><span class="co"># Simulated Misaligned Spatial Data</span></span>
<span><span class="co"># ==================================</span></span>
<span><span class="co"># Y-grid cells: 25</span></span>
<span><span class="co"># X-grid cells: 100</span></span>
<span><span class="co"># Atoms: 200</span></span>
<span><span class="co"># ...</span></span>
<span></span>
<span><span class="co"># ABRM results</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/run_abrm.html">run_abrm</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span>
<span><span class="co"># Output:</span></span>
<span><span class="co"># ABRM Model Results</span></span>
<span><span class="co"># ==================</span></span>
<span><span class="co"># Number of parameters estimated: 6</span></span>
<span><span class="co"># Mean absolute bias: 0.0234</span></span>
<span><span class="co"># Coverage rate: 95.00%</span></span>
<span><span class="co"># Use summary() for detailed parameter estimates</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span>  <span class="co"># Shows full parameter table</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="key-functions">Key Functions<a class="anchor" aria-label="anchor" href="#key-functions"></a>
</h2>
<table class="table">
<colgroup>
<col width="43%">
<col width="56%">
</colgroup>
<thead><tr>
<th>Function</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr>
<td><code><a href="reference/simulate_misaligned_data.html">simulate_misaligned_data()</a></code></td>
<td>Generate simulated spatial data with full parameter control</td>
</tr>
<tr>
<td><code><a href="reference/get_abrm_model.html">get_abrm_model()</a></code></td>
<td>Get NIMBLE model specification</td>
</tr>
<tr>
<td><code><a href="reference/run_abrm.html">run_abrm()</a></code></td>
<td>Run ABRM analysis (wrapper function)</td>
</tr>
<tr>
<td><code><a href="reference/run_nimble_model.html">run_nimble_model()</a></code></td>
<td>Run NIMBLE MCMC with diagnostics</td>
</tr>
<tr>
<td><code>prepare_spatial_bookkeeping()</code></td>
<td>Prepare spatial indices</td>
</tr>
<tr>
<td><code>prepare_adjacency_matrices()</code></td>
<td>Create spatial adjacency structures</td>
</tr>
<tr>
<td><code>prepare_nimble_inputs()</code></td>
<td>Prepare NIMBLE model inputs</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="data-simulation-parameters">Data Simulation Parameters<a class="anchor" aria-label="anchor" href="#data-simulation-parameters"></a>
</h2>
<p>The <code><a href="reference/simulate_misaligned_data.html">simulate_misaligned_data()</a></code> function accepts the following parameters:</p>
<p><strong>Reproducibility Parameters:</strong> - <code>seed</code>: Random seed for reproducibility</p>
<p><strong>Covariate Distributions:</strong> - <code>dist_covariates_x</code>: Vector of distribution types for X-grid covariates (e.g., <code>c('normal', 'poisson', 'binomial')</code>) - <code>dist_covariates_y</code>: Vector of distribution types for Y-grid covariates - <code>dist_y</code>: Distribution type for outcome variable (<code>'normal'</code>, <code>'poisson'</code>, or <code>'binomial'</code>)</p>
<p><strong>Data Generation Parameters:</strong> - <code>x_intercepts</code>: Intercepts for X-grid covariates (length must match <code>dist_covariates_x</code>) - <code>y_intercepts</code>: Intercepts for Y-grid covariates (length must match <code>dist_covariates_y</code>) - <code>beta0_y</code>: Intercept for the outcome model - <code>beta_x</code>: True coefficients for X-grid covariates in outcome model - <code>beta_y</code>: True coefficients for Y-grid covariates in outcome model</p>
<p><strong>Between-Variable Correlation:</strong> - <code>x_correlation</code>: Correlation between X-grid covariates (0 to 1) - <code>y_correlation</code>: Correlation between Y-grid covariates (0 to 1)</p>
</div>
<div class="section level2">
<h2 id="distribution-type-indices">Distribution Type Indices<a class="anchor" aria-label="anchor" href="#distribution-type-indices"></a>
</h2>
<p>When running ABRM models, you need to specify which covariates follow which distributions:</p>
<ul>
<li>
<code>norm_idx_x</code>, <code>norm_idx_y</code>: Indices of normally-distributed covariates</li>
<li>
<code>pois_idx_x</code>, <code>pois_idx_y</code>: Indices of Poisson-distributed covariates</li>
<li>
<code>binom_idx_x</code>, <code>binom_idx_y</code>: Indices of binomially-distributed covariates</li>
<li>
<code>dist_y</code>: Outcome distribution type (1=normal, 2=poisson, 3=binomial)</li>
</ul>
<p><strong>Example:</strong> If <code>dist_covariates_x = c('normal', 'poisson', 'binomial')</code>, then: - <code>norm_idx_x = 1</code> (first covariate) - <code>pois_idx_x = 2</code> (second covariate) - <code>binom_idx_x = 3</code> (third covariate)</p>
</div>
<div class="section level2">
<h2 id="requirements">Requirements<a class="anchor" aria-label="anchor" href="#requirements"></a>
</h2>
<ul>
<li>R &gt;= 4.0.0</li>
<li>
<strong>nimble</strong> for MCMC sampling (must be loaded)</li>
<li>Spatial packages: <strong>sp</strong>, <strong>sf</strong>, <strong>spdep</strong>, <strong>raster</strong>
</li>
<li>
<strong>BiasedUrn</strong> for multivariate hypergeometric sampling</li>
<li>MASS for multivariate normal generation</li>
<li>dplyr, tidyr for data manipulation</li>
</ul>
</div>
<div class="section level2">
<h2 id="funding-and-project-information">Funding and Project Information<a class="anchor" aria-label="anchor" href="#funding-and-project-information"></a>
</h2>
<p>This work was funded by the Robert Wood Johnson Foundation, Grant 81746. Project details are provided below.</p>
<p><strong>Project Title:</strong> Aligning spatially misaligned data for health equity analysis, action, and accountability</p>
<p><strong>Principal Investigators:</strong> Dr. Nancy Krieger (PI) and Dr. Rachel Nethery (co-PI)</p>
<p><strong>Start Date:</strong> July 2024</p>
<p><strong>Project Team and Collaborators:</strong> - Yunzhe Qian (Bella), MS (Research Assistant, Dept of Biostatistics, HSPH) - Rachel Nethery, PhD (Associate Professor, Dept of Biostatistics, HSPH) - Nancy Krieger, PhD (Professor, Department of Social and Behavioral Sciences (SBS), HSPH) - Nykesha Johnson, MPH (Statistical Data Analyst/Data Manager, SBS, HSPH)</p>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>If you use this package, please cite:</p>
<p>Qian Y, Nethery R, Krieger N, Johnson N (2026). spatialAtomizeR: Spatial Analysis with Misaligned Data Using Atom-Based Regression Models. R package version 0.2.6, <a href="https://github.com/bellayqian/spatialAtomizeR" class="external-link uri">https://github.com/bellayqian/spatialAtomizeR</a>.</p>
</div>
<div class="section level2">
<h2 id="about">About<a class="anchor" aria-label="anchor" href="#about"></a>
</h2>
<p>Atom-based regression models (ABRM) were originally proposed by:</p>
<p>Mugglin, A. S., Carlin, B. P., &amp; Gelfand, A. E. (2000). Fully model-based approaches for spatially misaligned data. Journal of the American Statistical Association, 95(451), 877-887.</p>
<p>The methods were further investigated in:</p>
<p>Trevisani, M., &amp; Gelfand, A. E. (2013). Spatial misalignment models for small area estimation: A simulation study. In Advances in Theoretical and Applied Statistics (pp. 269-279). Springer.</p>
<p>This package builds upon the applied work in:</p>
<p>Nethery, R. C., Testa, C., Tabb, L. P., Hanage, W. P., Chen, J. T., &amp; Krieger, N. (2023). Addressing spatial misalignment in population health research: a case study of US congressional district political metrics and county health data. MedRxiv.</p>
<p><strong>Spatial misalignment</strong>—which occurs when data on multiple variables are collected using mismatched geographic boundary definitions—is a longstanding challenge in public health research. For instance, congressional districts can cut across multiple counties, and environmental hazard zones may cross census tract boundaries, in both cases creating intersecting areas that complicate efforts to study the relationships between health outcomes and their social, political, and environmental determinants.</p>
<p><strong>Atom-based regression models (ABRM)</strong> offer a promising alternative by using atoms—the intersecting areas of all relevant units—as the fundamental units of analysis. By preserving the original spatial resolution of the data, ABRM account for uncertainty in statistical relationships while offering a robust method for handling misaligned data.</p>
</div>
<div class="section level2">
<h2 id="getting-help">Getting Help<a class="anchor" aria-label="anchor" href="#getting-help"></a>
</h2>
<ul>
<li>
<strong>Report bugs</strong>: <a href="https://github.com/bellayqian/spatialAtomizeR/issues" class="external-link uri">https://github.com/bellayqian/spatialAtomizeR/issues</a>
</li>
<li>
<strong>Documentation</strong>: <code><a href="reference/spatialAtomizeR-package.html">?spatialAtomizeR</a></code>
</li>
<li>
<strong>Vignette</strong>: <code><a href="articles/getting-started.html">vignette("getting-started", package = "spatialAtomizeR")</a></code>
</li>
<li>
<strong>Function help</strong>: <code><a href="reference/simulate_misaligned_data.html">?simulate_misaligned_data</a></code>, <code><a href="reference/run_abrm.html">?run_abrm</a></code>, etc.</li>
</ul>
</div>
<div class="section level2">
<h2 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h2>
<p>MIT License</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=spatialAtomizeR" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/bellayqian/spatialAtomizeR/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/bellayqian/spatialAtomizeR/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing spatialAtomizeR</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Yunzhe Qian <br><small class="roles"> Author, maintainer </small>   </li>
<li>Rachel Nethery <br><small class="roles"> Author </small>   </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Yunzhe Qian, Rachel Nethery.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
