% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/methods.R
\name{waic.abrm}
\alias{waic.abrm}
\title{WAIC for an ABRM Object}
\usage{
\method{waic}{abrm}(object, ...)
}
\arguments{
\item{object}{An object of class \code{"abrm"} returned by
\code{\link{run_abrm}}.}

\item{...}{Additional arguments (currently unused).}
}
\value{
An object of class \code{"waic_abrm"}, which is a named list with
  components:
  \describe{
    \item{\code{waic}}{The scalar WAIC value. Lower values indicate better
      predictive accuracy penalised for model complexity.}
    \item{\code{lppd}}{Log pointwise predictive density — the
      goodness-of-fit component of WAIC.}
    \item{\code{penalty}}{The effective number of parameters
      (\eqn{p_{\mathrm{WAIC}}}) — the complexity penalty component.}
    \item{\code{n_params}}{The number of regression parameters estimated.}
  }
  Returns an error if the model was not fitted with
  \code{compute_waic = TRUE}.
}
\description{
Returns the Widely Applicable Information Criterion (WAIC) for a fitted
ABRM. WAIC is the recommended information criterion for Bayesian models and
is computed by NIMBLE when \code{compute_waic = TRUE} is passed to
\code{\link{run_abrm}}.
}
\details{
WAIC (Watanabe 2010) is defined as:
\deqn{\mathrm{WAIC} = -2 \cdot \mathrm{lppd} + 2 \cdot p_{\mathrm{WAIC}}}
where \eqn{\mathrm{lppd}} is the log pointwise predictive density and
\eqn{p_{\mathrm{WAIC}}} is the effective number of parameters. Unlike AIC,
WAIC is fully Bayesian and averages over the posterior distribution rather
than evaluating at a point estimate.

WAIC values are only meaningful when compared between models fitted on
\emph{identical} data with the same outcome distribution. A true marginal
log-likelihood is not available for ABRM, so \code{\link[stats]{AIC}} and
\code{\link[stats]{logLik}} are not supported; use \code{waic()} instead.
}
\examples{
\donttest{
  sim_data <- simulate_misaligned_data(
    seed              = 1,
    dist_covariates_x = "normal",
    dist_covariates_y = "normal",
    dist_y            = "normal",
    x_intercepts      = 0,
    y_intercepts      = 0,
    beta0_y           = 0,
    beta_x            = 0.1,
    beta_y            = -0.1
  )
  results <- run_abrm(
    gridx        = sim_data$gridx,
    gridy        = sim_data$gridy,
    atoms        = sim_data$atoms,
    model_code   = get_abrm_model(),
    norm_idx_x   = 1,
    norm_idx_y   = 1,
    dist_y       = 1,
    niter        = 1000,
    nburnin      = 500,
    nchains      = 2,
    seed         = 1,
    compute_waic = TRUE    # required; re-fit if this was FALSE
  )

  w <- waic(results)
  print(w)          # formatted table: WAIC, lppd, pWAIC, n_params
  w$waic            # raw scalar for comparing models
  w$penalty         # effective number of parameters (pWAIC)
}

}
\references{
Watanabe, S. (2010). Asymptotic equivalence of Bayes cross validation and
widely applicable information criterion in singular learning theory.
\emph{Journal of Machine Learning Research}, 11, 3571--3594.
}
\seealso{
\code{\link{waic}}, \code{\link{print.waic_abrm}},
  \code{\link{run_abrm}}
}
