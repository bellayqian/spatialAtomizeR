% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/methods.R
\name{fitted.abrm}
\alias{fitted.abrm}
\title{Fitted Values for an ABRM Object}
\usage{
\method{fitted}{abrm}(object, gridy = NULL, gridx = NULL, atoms = NULL, ...)
}
\arguments{
\item{object}{An object of class \code{"abrm"} returned by \code{\link{run_abrm}}.}

\item{gridy}{The Y-grid \code{sf} data frame used to fit the model.
Must contain columns named \code{covariate_y_1}, \code{covariate_y_2}, etc.}

\item{gridx}{The X-grid \code{sf} data frame used to fit the model.
Must contain columns named \code{covariate_x_1}, \code{covariate_x_2}, etc.}

\item{atoms}{The atoms \code{sf} data frame containing \code{ID_y} and
\code{ID_x} linking atoms to their parent Y- and X-grid cells, plus a
\code{population} column for offset weighting.}

\item{...}{Additional arguments (currently unused).}
}
\value{
A named numeric vector of posterior-mean fitted values (on the linear predictor scale), one per Y-grid cell.
}
\description{
Computes posterior-mean fitted values at the Y-grid level by applying the
estimated regression coefficients to the supplied covariate data. Because
the \code{abrm} object does not store the original grids, \code{gridy} and
\code{gridx} must be supplied by the user.
}
\examples{
\donttest{
  sim_data <- simulate_misaligned_data(
    seed = 1, dist_covariates_x = "normal", dist_covariates_y = "normal",
    dist_y = "normal", x_intercepts = 0, y_intercepts = 0,
    beta0_y = 0, beta_x = 0.1, beta_y = -0.1
  )
  results <- run_abrm(
    gridx = sim_data$gridx, gridy = sim_data$gridy, atoms = sim_data$atoms,
    model_code = get_abrm_model(), norm_idx_x = 1, norm_idx_y = 1,
    dist_y = 1, niter = 1000, nburnin = 500, nchains = 2, seed = 1,
    save_plots = FALSE
  )
  fitted(results,
         gridy = sim_data$gridy,
         gridx = sim_data$gridx,
         atoms = sim_data$atoms)
}

}
